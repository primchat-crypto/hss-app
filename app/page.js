// app/page.js ‚Äî Human System Studio v5
"use client";
import { useState, useEffect } from "react";

const BRAND = "Human System Studio";
const PLANS = {
  free:{ name:"Free",price:0,tag:"üü¢",c:"#10B981",f:["identity","core5"] },
  deep:{ name:"Deep Insight",price:99,tag:"üü°",c:"#F59E0B",badge:"‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°",f:["identity","core5","12d","shadow","weekly","energy"] },
  all:{ name:"All Access",price:249,tag:"üîµ",c:"#3B82F6",badge:"‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î",f:["identity","core5","12d","shadow","weekly","energy","job","pdf","share"] }
};
const FT=[["Identity Snapshot (AI)","identity",1,1,1],["5 Core Scores + AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå","core5",1,1,1],["‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á / ‡∏à‡∏∏‡∏î‡∏û‡∏±‡∏í‡∏ô‡∏≤ 12 ‡∏°‡∏¥‡∏ï‡∏¥","12d",0,1,1],["Shadow Analysis ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å","shadow",0,1,1],["Do & Don't ‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå","weekly",0,1,1],["7-Day Energy Forecast","energy",0,1,1],["Job Matching AI","job",0,0,1],["PDF Report ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î","pdf",0,0,1],["Shareable Profile Link","share",0,0,1]];

const QG={A:{t:"The Foundation",dims:{"Cognitive Processing":{icon:"üß†",c:"#6366F1",pl:"‡∏û‡∏∏‡∏ò",q:["‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô ‡∏â‡∏±‡∏ô‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Ñ‡∏£‡πà‡∏≤‡∏ß‡πÜ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á","‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏≤‡∏Å ‡∏â‡∏±‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏î‡πâ","‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô ‡∏â‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏≤‡∏ô‡∏à‡∏∏‡∏î‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"]},"Emotional Regulation":{icon:"üåä",c:"#0EA5E9",pl:"‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå",q:["‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏£‡∏á ‡∏â‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à","‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÑ‡∏°‡πà‡∏î‡∏µ ‡∏â‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á","‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏à‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÉ‡∏à ‡∏â‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏Å‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1‚Äì2 ‡∏ß‡∏±‡∏ô"]},"Identity Stability":{icon:"‚öì",c:"#EC4899",pl:"‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå+‡πÄ‡∏™‡∏≤‡∏£‡πå",q:["‡∏â‡∏±‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡πÅ‡∏£‡∏á‡∏Å‡∏î‡∏î‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô","‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ï‡∏¥ ‡∏â‡∏±‡∏ô‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤","‡∏â‡∏±‡∏ô‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå"]}}},B:{t:"The Execution",dims:{"Energy Management":{icon:"‚ö°",c:"#F59E0B",pl:"‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£",q:["‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏â‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á","‡∏â‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏´‡∏•‡∏∏‡∏î‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ö‡πà‡∏≠‡∏¢","‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡πâ‡∏≤ ‡∏â‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏±‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ü‡∏∑‡πâ‡∏ô‡∏û‡∏•‡∏±‡∏á ‡πÅ‡∏ó‡∏ô‡∏ù‡∏∑‡∏ô‡∏ó‡∏≥‡∏ï‡πà‡∏≠"]},"Decision System":{icon:"‚öñÔ∏è",c:"#3B82F6",pl:"‡∏û‡∏§‡∏´‡∏±‡∏™+‡πÄ‡∏™‡∏≤‡∏£‡πå",q:["‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏â‡∏±‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á","‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡∏â‡∏±‡∏ô‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏¢‡πâ‡∏≠‡∏ô‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏ã‡πâ‡∏≥","‡∏â‡∏±‡∏ô‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏ú‡∏•‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏™‡∏π‡∏á"]},"Responsibility Load":{icon:"üèãÔ∏è",c:"#8B5CF6",pl:"‡πÄ‡∏™‡∏≤‡∏£‡πå",q:["‡∏â‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏≥","‡∏ñ‡πâ‡∏≤‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô ‡∏â‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å","‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏° ‡∏â‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à"]}}},C:{t:"The Interaction",dims:{"Motivation Driver":{icon:"üî•",c:"#F97316",pl:"‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå",q:["‡∏â‡∏±‡∏ô‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î","‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏´‡πá‡∏ô‡∏ï‡πà‡∏≤‡∏á ‡∏â‡∏±‡∏ô‡∏Å‡∏•‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á","‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏â‡∏±‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á"]},"Boundary System":{icon:"üõ°Ô∏è",c:"#10B981",pl:"‡πÄ‡∏™‡∏≤‡∏£‡πå+‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå",q:["‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏Ç‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á ‡∏â‡∏±‡∏ô‡∏Å‡∏•‡πâ‡∏≤‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï","‡∏â‡∏±‡∏ô‡∏°‡∏µ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå","‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏à‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏â‡∏±‡∏ô‡∏°‡∏µ‡∏ß‡∏¥‡∏ò‡∏µ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á"]},"Stress Response":{icon:"üßä",c:"#64748B",pl:"‡πÄ‡∏™‡∏≤‡∏£‡πå",q:["‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏î‡∏î‡∏±‡∏ô ‡∏â‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡πÑ‡∏î‡πâ","‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏â‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á","‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏≥ ‡∏â‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏´‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡∏û‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≥"]}}},D:{t:"The Evolution & Shadow",dims:{"Shadow Pattern":{icon:"üåë",c:"#1E293B",pl:"‡∏£‡∏≤‡∏´‡∏π/‡πÄ‡∏Å‡∏ï‡∏∏",rev:true,q:["‡∏â‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÑ‡∏õ‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ö‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏ó‡∏ô","‡∏â‡∏±‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏•‡∏±‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≤‡∏ô‡∏∂‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á","‡∏â‡∏±‡∏ô‡∏ú‡∏±‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç ‡πÅ‡∏°‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ã‡πâ‡∏≥"]},"Growth Orientation":{icon:"üå±",c:"#10B981",pl:"‡∏û‡∏§‡∏´‡∏±‡∏™",q:["‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‡∏â‡∏±‡∏ô‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î","‡∏â‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞ 30 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á","‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏û‡∏•‡∏≤‡∏î ‡∏â‡∏±‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ"]},"Integration Level":{icon:"üîÆ",c:"#A78BFA",pl:"‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏î‡∏≤‡∏ß",q:["‡∏â‡∏±‡∏ô‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1 ‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ä‡∏±‡∏î‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ","‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏â‡∏±‡∏ô‡∏°‡∏µ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏û‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á","‡∏â‡∏±‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏£‡∏¥‡∏á"]}}}};

const flatQ=()=>{const f=[];Object.entries(QG).forEach(([,g])=>Object.entries(g.dims).forEach(([d,data])=>data.q.forEach((q,i)=>f.push({dim:d,q,icon:data.icon,c:data.c,rev:data.rev||false,qi:i,pl:data.pl}))));return f};
const ALL_Q=flatQ();
const SCALE=["‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡∏à‡∏£‡∏¥‡∏á","‡∏ô‡∏≤‡∏ô‡πÜ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á","‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á","‡∏ö‡πà‡∏≠‡∏¢","‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏°‡∏≤‡∏Å"];
const DM={};Object.values(QG).forEach(g=>Object.entries(g.dims).forEach(([k,v])=>{DM[k]=v}));
const DIMS=Object.keys(DM);
const TS=[{id:"dawn",l:"üåÖ ‡πÄ‡∏ä‡πâ‡∏≤‡∏°‡∏∑‡∏î (04:00‚Äì06:00)",d:"‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô"},{id:"morning",l:"‚òÄÔ∏è ‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏≤‡∏¢ (09:00‚Äì11:00)",d:"‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏π‡∏á"},{id:"noon",l:"üåû ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á/‡∏ö‡πà‡∏≤‡∏¢‡∏ï‡πâ‡∏ô (12:00‚Äì14:00)",d:"‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏®‡∏µ‡∏£‡∏©‡∏∞"},{id:"evening",l:"üåá ‡πÄ‡∏¢‡πá‡∏ô/‡∏û‡∏•‡∏ö‡∏Ñ‡πà‡∏≥ (17:00‚Äì19:00)",d:"‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏ï‡∏Å"},{id:"night",l:"üåô ‡∏î‡∏∂‡∏Å (22:00‚Äì24:00)",d:"‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô"}];
const PV=["‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£","‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà","‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ","‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤","‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï","‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô","‡∏™‡∏á‡∏Ç‡∏•‡∏≤","‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢","‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ","‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£","‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ","‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ","‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä","‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ","‡∏£‡∏∞‡∏¢‡∏≠‡∏á","‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà","‡∏•‡∏≥‡∏õ‡∏≤‡∏á","‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å","‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ","‡∏≠‡∏∑‡πà‡∏ô‡πÜ"];

// Vedic scoring
const calcV=(bd,ts)=>{const m=parseInt(bd?.split("-")?.[1])||6;const d=parseInt(bd?.split("-")?.[2])||15;const s=(m*31+d)%100;const tb={dawn:5,morning:3,noon:0,evening:2,night:-2}[ts]||0;const ps={me:Math.min(40,20+(s%20)+tb),mo:Math.min(40,18+((s*3)%22)+tb),su:Math.min(40,22+((s*7)%18)+tb),ma:Math.min(40,19+((s*11)%21)+tb),ju:Math.min(40,21+((s*13)%19)+tb),sa:Math.min(40,17+((s*17)%23)+tb),ra:Math.min(40,15+((s*19)%25)+tb)};const f=(p,i)=>Math.min(100,p+Math.min(25,10+((s+i)%15))+Math.min(20,8+((s*2+i)%12))+Math.min(15,5+((s*3+i)%10)));return{"Cognitive Processing":f(ps.me,1)/10,"Emotional Regulation":f(ps.mo,2)/10,"Identity Stability":f(Math.round((ps.su+ps.sa)/2),3)/10,"Energy Management":f(ps.ma,4)/10,"Decision System":f(Math.round((ps.ju+ps.sa)/2),5)/10,"Responsibility Load":f(ps.sa,6)/10,"Motivation Driver":f(ps.su,7)/10,"Boundary System":f(Math.round((ps.sa+ps.mo)/2),8)/10,"Stress Response":f(ps.sa,9)/10,"Shadow Pattern":f(ps.ra,10)/10,"Growth Orientation":f(ps.ju,11)/10,"Integration Level":f(Math.round(Object.values(ps).reduce((a,b)=>a+b,0)/7),12)/10}};

const calcS=(v,ans)=>{const sc={};DIMS.forEach(dim=>{const vd=v[dim]||5;let raw=0,cnt=0;const dd=DM[dim];if(dd)dd.q.forEach((_,i)=>{const k=`${dim}-${i}`;if(ans[k]!==undefined){let val=ans[k];if(dd.rev)val=4-val;raw+=val;cnt++}});const ap=cnt>0?(raw/(cnt*4))*10:5;let fi=vd*0.6+ap*0.4;if(vd>7&&ap<4)fi-=1.5;if(vd<4&&ap>7)fi+=0.5;sc[dim]=Math.max(0,Math.min(10,Math.round(fi*10)/10))});return sc};

// GPT API
const GPT={cache:{},call:async(prompt,key)=>{if(key&&GPT.cache[key])return GPT.cache[key];const ak=typeof window!=="undefined"?process.env.NEXT_PUBLIC_OPENAI_API_KEY:null;if(!ak)return GPT.fb(key);try{const r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json","Authorization":`Bearer ${ak}`},body:JSON.stringify({model:"gpt-4o-mini",max_tokens:800,temperature:0.7,messages:[{role:"system",content:"‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏ä‡∏¥‡∏á‡πÇ‡∏´‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏û‡∏£‡∏∞‡πÄ‡∏ß‡∏ó ‡∏ï‡∏≠‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏≠‡∏á ‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏à ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏î‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏°‡∏¥‡∏ï‡∏¥"},{role:"user",content:prompt}]})});const d=await r.json();const t=d.choices?.[0]?.message?.content||"";if(key)GPT.cache[key]=t;return t}catch(e){return GPT.fb(key)}},fb:(key)=>{if(!key)return"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...";if(key.startsWith("id_"))return"‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î ‡∏î‡∏≤‡∏ß‡∏ö‡πà‡∏á‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏û‡∏•‡∏±‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏™‡∏π‡∏á ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏ß‡∏á‡∏Å‡∏±‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏•‡∏≠‡∏á‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏°‡∏¥‡∏ï‡∏¥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà";if(key.startsWith("core_"))return"üß† Cognitive (‡∏û‡∏∏‡∏ò): ‡∏î‡∏≤‡∏ß‡∏û‡∏∏‡∏ò‡∏™‡πà‡∏á‡∏û‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏•‡∏≠‡∏á‡∏ù‡∏∂‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n\nüåä Emotional (‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå): ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå ‡∏ù‡∏∂‡∏Å‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ö\n\n‚öì Identity (‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå+‡πÄ‡∏™‡∏≤‡∏£‡πå): ‡πÅ‡∏Å‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡∏¢‡∏∂‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô\n\nüåë Shadow (‡∏£‡∏≤‡∏´‡∏π/‡πÄ‡∏Å‡∏ï‡∏∏): ‡∏à‡∏∏‡∏î‡∏ö‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç\n\nüå± Growth (‡∏û‡∏§‡∏´‡∏±‡∏™): ‡∏û‡∏§‡∏´‡∏±‡∏™‡πÄ‡∏õ‡∏¥‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á";if(key.startsWith("sh_"))return"‚ö° Trigger ‡∏´‡∏•‡∏±‡∏Å: ‡∏£‡∏≤‡∏´‡∏π‡∏ä‡∏µ‡πâ‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏°‡∏±‡∏Å‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡πà‡∏á‡∏£‡∏±‡∏î‡∏à‡∏ô‡∏Ç‡∏≤‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏¥‡∏î\n\nüîÑ Pattern ‡∏ã‡πâ‡∏≥: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≠ trigger ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏±‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ö‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏ï‡∏£‡∏á ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ loop ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏ï‡∏∏‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô\n\nüí° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ: ‡∏ù‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏≠‡∏¢‡∏≤‡∏Å‡∏´‡∏ô‡∏µ ‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà";if(key.startsWith("f12_"))return"üí™ ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á:\n1. ‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏∏‡∏ô‡∏™‡πà‡∏á‡∏û‡∏•‡∏±‡∏á‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û\n2. ‡∏û‡∏•‡∏±‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡∏π‡∏á\n3. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô\n4. ‡πÅ‡∏£‡∏á‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á\n\n‚ö†Ô∏è ‡∏à‡∏∏‡∏î‡∏û‡∏±‡∏í‡∏ô‡∏≤:\n1. ‡∏ù‡∏∂‡∏Å‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô\n2. ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö\n3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏û‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠\n4. ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏à‡∏∏‡∏î‡∏ö‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏´‡∏π/‡πÄ‡∏Å‡∏ï‡∏∏‡∏ä‡∏µ‡πâ";return null}};
const pJ=t=>{if(!t)return null;try{return JSON.parse(t.replace(/```json\s*/g,"").replace(/```/g,"").trim())}catch{return null}};

// Store
const ST={set:(k,v)=>{try{localStorage.setItem(`hss5_${k}`,JSON.stringify(v))}catch{}},get:k=>{try{const s=localStorage.getItem(`hss5_${k}`);return s?JSON.parse(s):null}catch{return null}}};

// CSS
const css=`@keyframes hs{to{transform:rotate(360deg)}}@keyframes hb{50%{opacity:0}}@keyframes hf{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}@keyframes hfl{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}`;

// UI
const Spin=({t="AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå..."})=><div style={{padding:"12px 0",display:"flex",alignItems:"center",gap:8}}><div style={{width:16,height:16,borderRadius:"50%",border:"2.5px solid #E0E7FF",borderTopColor:"#6366F1",animation:"hs .7s linear infinite"}}/><span style={{fontSize:12,color:"#6366F1",fontWeight:600}}>{t}</span></div>;

const Typer=({text})=>{const[s,setS]=useState("");const[d,setD]=useState(false);useEffect(()=>{if(!text)return;let i=0;setS("");setD(false);const iv=setInterval(()=>{i+=3;if(i>=text.length){setS(text);setD(true);clearInterval(iv)}else setS(text.slice(0,i))},12);return()=>clearInterval(iv)},[text]);return<div style={{fontSize:13,lineHeight:1.8,color:"#374151",whiteSpace:"pre-wrap"}}>{s}{!d&&<span style={{display:"inline-block",width:2,height:14,background:"#6366F1",marginLeft:1,animation:"hb .8s step-end infinite"}}/>}</div>};

const Spider=({scores,size=260})=>{const keys=Object.keys(scores);const vals=Object.values(scores);const n=keys.length;const cx=size/2,cy=size/2,r=size*.34;const pt=(i,v)=>{const a=Math.PI*2*i/n-Math.PI/2;return{x:cx+Math.cos(a)*v/10*r,y:cy+Math.sin(a)*v/10*r}};return<svg viewBox={`0 0 ${size} ${size}`} style={{width:"100%",maxWidth:280}}>{[2,4,6,8,10].map(l=><polygon key={l} points={keys.map((_,i)=>{const p=pt(i,l);return`${p.x},${p.y}`}).join(" ")} fill="none" stroke="#E5E7EB" strokeWidth=".6"/>)}{keys.map((_,i)=>{const p=pt(i,10);return<line key={i} x1={cx} y1={cy} x2={p.x} y2={p.y} stroke="#F3F4F6" strokeWidth=".4"/>})}<polygon points={keys.map((_,i)=>{const p=pt(i,vals[i]);return`${p.x},${p.y}`}).join(" ")} fill="rgba(99,102,241,.12)" stroke="#6366F1" strokeWidth="1.8"/>{keys.map((_,i)=>{const p=pt(i,vals[i]);return<circle key={i} cx={p.x} cy={p.y} r="2.5" fill="#6366F1" stroke="#fff" strokeWidth="1.2"/>})}{keys.map((k,i)=>{const p=pt(i,12.2);const sh=k.length>12?k.slice(0,10)+"‚Ä¶":k;return<text key={i} x={p.x} y={p.y} textAnchor="middle" dominantBaseline="middle" style={{fontSize:"5.2px",fill:"#6B7280",fontWeight:500}}>{sh}</text>})}</svg>};

const Card=({children,style={}})=><div style={{background:"#fff",borderRadius:14,padding:"16px 18px",marginBottom:10,boxShadow:"0 1px 3px rgba(0,0,0,.04)",border:"1px solid #F1F5F9",...style}}>{children}</div>;
const Btn=({children,ok=true,onClick,style={}})=><button onClick={ok?onClick:undefined} style={{padding:"12px 20px",fontSize:14,fontWeight:700,background:ok?"linear-gradient(135deg,#4338CA,#6D28D9)":"#E2E8F0",color:ok?"#fff":"#94A3B8",border:"none",borderRadius:10,cursor:ok?"pointer":"not-allowed",width:"100%",boxShadow:ok?"0 4px 14px rgba(79,70,229,.2)":"none",...style}}>{children}</button>;

// ‚ïê‚ïê‚ïê MAIN APP ‚ïê‚ïê‚ïê
export default function App(){
  const[sc,setSc]=useState("landing");
  const[nick,setNick]=useState("");const[email,setEmail]=useState("");const[bday,setBday]=useState("");
  const[knowT,setKnowT]=useState(null);const[btime,setBtime]=useState("");const[tSlot,setTSlot]=useState("");const[prov,setProv]=useState("");
  const[qI,setQI]=useState(0);const[ans,setAns]=useState({});
  const[scores,setScores]=useState(null);const[vedic,setVedic]=useState(null);
  const[plan,setPlan]=useState("free");const[ai,setAi]=useState({});const[aiL,setAiL]=useState({});

  useEffect(()=>{const sc2=ST.get("scores");const vd=ST.get("vedic");const p=ST.get("profile");const pl=ST.get("plan");const a=ST.get("answers");if(p){setNick(p.nick||"");setEmail(p.email||"");setBday(p.bday||"");setBtime(p.btime||"");setTSlot(p.tSlot||"");setProv(p.prov||"")}if(a)setAns(a);if(pl)setPlan(pl);if(sc2&&vd){setScores(sc2);setVedic(vd);setSc("results")}},[]);

  const has=f=>PLANS[plan].f.includes(f);

  const goQuiz=()=>{ST.set("profile",{nick,email,bday,btime,tSlot,prov});setSc("quiz")};

  const answer=val=>{const q=ALL_Q[qI];const key=`${q.dim}-${q.qi}`;const na={...ans,[key]:val};setAns(na);ST.set("answers",na);if(qI<ALL_Q.length-1)setTimeout(()=>setQI(qI+1),200)};

  const finish=()=>{const ts=knowT?btime:tSlot;const v=calcV(bday,ts);const s=calcS(v,ans);setVedic(v);setScores(s);ST.set("vedic",v);ST.set("scores",s);setSc("results");loadAI("identity",s,v);loadAI("core",s,v)};

  const loadAI=async(type,s2,v2)=>{const s=s2||scores;const v=v2||vedic;if(!s||!nick||ai[type])return;setAiL(p=>({...p,[type]:true}));let r=null;try{const so=Object.entries(s).sort((a,b)=>b[1]-a[1]);
    if(type==="identity")r=await GPT.call(`‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô"${nick}"3‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ Vedic+‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°:\n‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏î‡∏ß‡∏á:${Object.entries(v).sort((a,b)=>b[1]-a[1]).slice(0,3).map(([k,v2])=>`${k}(${v2.toFixed(1)})`).join(",")}\n‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°:‡πÅ‡∏Ç‡πá‡∏á${so.slice(0,3).map(([k,v2])=>`${k}(${v2.toFixed(1)})`).join(",")} ‡∏≠‡πà‡∏≠‡∏ô${so.slice(-2).map(([k,v2])=>`${k}(${v2.toFixed(1)})`).join(",")}\n‡∏ñ‡πâ‡∏≤‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡πÅ‡∏ï‡πà‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ï‡πà‡∏≥‚Üí"‡∏î‡∏ß‡∏á‡πÉ‡∏´‡πâ‡∏°‡∏≤‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°" ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâbullet`,`id_${nick}`);
    if(type==="core")r=await GPT.call(`‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå5Core"${nick}"Vedic:\nüß†Cognitive(‡∏û‡∏∏‡∏ò):‡∏î‡∏ß‡∏á${v["Cognitive Processing"]?.toFixed(1)}‡∏à‡∏£‡∏¥‡∏á${s["Cognitive Processing"]?.toFixed(1)}\nüåäEmotional(‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå):‡∏î‡∏ß‡∏á${v["Emotional Regulation"]?.toFixed(1)}‡∏à‡∏£‡∏¥‡∏á${s["Emotional Regulation"]?.toFixed(1)}\n‚öìIdentity(‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå+‡πÄ‡∏™‡∏≤‡∏£‡πå):‡∏î‡∏ß‡∏á${v["Identity Stability"]?.toFixed(1)}‡∏à‡∏£‡∏¥‡∏á${s["Identity Stability"]?.toFixed(1)}\nüåëShadow(‡∏£‡∏≤‡∏´‡∏π/‡πÄ‡∏Å‡∏ï‡∏∏):‡∏î‡∏ß‡∏á${v["Shadow Pattern"]?.toFixed(1)}‡∏à‡∏£‡∏¥‡∏á${s["Shadow Pattern"]?.toFixed(1)}\nüå±Growth(‡∏û‡∏§‡∏´‡∏±‡∏™):‡∏î‡∏ß‡∏á${v["Growth Orientation"]?.toFixed(1)}‡∏à‡∏£‡∏¥‡∏á${s["Growth Orientation"]?.toFixed(1)}\n‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πâ‡∏≤‡∏ô1-2‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ ‡∏ñ‡πâ‡∏≤diff>2‚Üí"gap‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç"`,`core_${nick}`);
    if(type==="12d")r=await GPT.call(`‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå12‡∏°‡∏¥‡∏ï‡∏¥"${nick}"Vedic:\n${Object.entries(s).map(([k,sv])=>`${k}:‡∏î‡∏ß‡∏á${v[k]?.toFixed(1)}‡∏à‡∏£‡∏¥‡∏á${sv.toFixed(1)}`).join("\n")}\n‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á4+‡∏î‡∏≤‡∏ß‡∏´‡∏ô‡∏∏‡∏ô ‡∏à‡∏∏‡∏î‡∏û‡∏±‡∏í‡∏ô‡∏≤4+action ‡∏ñ‡πâ‡∏≤gap>2‚Üíhighlight`,`f12_${nick}`);
    if(type==="shadow")r=await GPT.call(`Shadow"${nick}"Vedic(‡∏£‡∏≤‡∏´‡∏π/‡πÄ‡∏Å‡∏ï‡∏∏):\nShadow:‡∏î‡∏ß‡∏á${v["Shadow Pattern"]?.toFixed(1)}‡∏à‡∏£‡∏¥‡∏á${s["Shadow Pattern"]?.toFixed(1)}\nStress:${s["Stress Response"]?.toFixed(1)} Boundary:${s["Boundary System"]?.toFixed(1)}\n‚ö°Trigger üîÑPattern üí°‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡∏ï‡∏≤‡∏°‡∏î‡∏≤‡∏ß`,`sh_${nick}`);
    if(type==="weekly"){const t=await GPT.call(`‡πÇ‡∏´‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏û‡∏£‡∏∞‡πÄ‡∏ß‡∏ó ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå"${nick}":\n‡πÅ‡∏Ç‡πá‡∏á:${so.slice(0,3).map(([k])=>k).join(",")} ‡∏≠‡πà‡∏≠‡∏ô:${so.slice(-2).map(([k])=>k).join(",")}\n‡∏ï‡∏≠‡∏öJSON‡πÑ‡∏°‡πà‡∏°‡∏µbacktick:{"do":["‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥1","‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥2","‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥3"],"dont":["‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á1","‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á2","‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á3"]}`,`wk_${nick}`);r=pJ(t)}
    if(type==="energy"){const t=await GPT.call(`‡πÇ‡∏´‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô7‡∏ß‡∏±‡∏ô"${nick}"‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå+‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£:\nEmotional:${s["Emotional Regulation"]?.toFixed(1)} Energy:${s["Energy Management"]?.toFixed(1)}\nJSON:[{"day":"‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå","energy":75,"mood":"üòä‡∏°‡∏µ‡∏û‡∏•‡∏±‡∏á"},{"day":"‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£","energy":60,"mood":"üòê‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á"},{"day":"‡∏û‡∏∏‡∏ò","energy":80,"mood":"üî•‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏î‡∏µ"},{"day":"‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ","energy":55,"mood":"üò¥‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å"},{"day":"‡∏®‡∏∏‡∏Å‡∏£‡πå","energy":85,"mood":"‚ú®‡∏™‡∏î‡πÉ‡∏™"},{"day":"‡πÄ‡∏™‡∏≤‡∏£‡πå","energy":70,"mood":"üåø‡∏™‡∏á‡∏ö"},{"day":"‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå","energy":65,"mood":"üåô‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô"}]`,`en_${nick}`);r=pJ(t)}
    if(type==="job"){const t=await GPT.call(`‡∏≠‡∏≤‡∏ä‡∏µ‡∏û+‡πÇ‡∏´‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå"${nick}"‡πÅ‡∏Ç‡πá‡∏á:${so.slice(0,4).map(([k,v2])=>`${k}(${v2.toFixed(1)})`).join(",")}\nJSON:[{"title":"‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á1","match":88,"reason":"‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÑ‡∏ó‡∏¢"},{"title":"‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á2","match":82,"reason":"..."},{"title":"‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á3","match":78,"reason":"..."}]`,`job_${nick}`);r=pJ(t)}
  }catch{}setAi(p=>({...p,[type]:r}));setAiL(p=>({...p,[type]:false}))};

  const upgradePlan=p=>{setPlan(p);ST.set("plan",p);if(PLANS[p].f.includes("12d")&&!ai["12d"])loadAI("12d");if(PLANS[p].f.includes("shadow")&&!ai.shadow)loadAI("shadow");if(PLANS[p].f.includes("weekly")&&!ai.weekly)loadAI("weekly");if(PLANS[p].f.includes("energy")&&!ai.energy)loadAI("energy");if(PLANS[p].f.includes("job")&&!ai.job)loadAI("job")};

  const exportPDF=()=>{if(!scores)return;const so=Object.entries(scores).sort((a,b)=>b[1]-a[1]);const w=window.open("","_blank");const wkHtml=ai.weekly&&typeof ai.weekly==="object"?`<h2>Do & Don't ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</h2><div class="g"><div class="card" style="background:#ECFDF5"><b style="color:#059669">‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥</b>${(ai.weekly.do||[]).map(t=>`<p>‚Ä¢ ${t}</p>`).join("")}</div><div class="card" style="background:#FFF1F2"><b style="color:#EF4444">‚ùå ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á</b>${(ai.weekly.dont||[]).map(t=>`<p>‚Ä¢ ${t}</p>`).join("")}</div></div>`:"";const enHtml=ai.energy&&Array.isArray(ai.energy)?`<h2>7-Day Energy Forecast</h2>${ai.energy.map(d=>`<div style="display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid #eee"><span>${d.day} ${d.mood||""}</span><b style="color:${d.energy>70?"#059669":"#F59E0B"}">${d.energy}%</b></div>`).join("")}`:"";const jobHtml=ai.job&&Array.isArray(ai.job)?`<h2>Job Matching AI</h2>${ai.job.map(j=>`<div class="card"><div style="display:flex;justify-content:space-between"><b>${j.title}</b><span style="color:#4338CA">${j.match}%</span></div><p style="color:#64748B;font-size:12px">${j.reason}</p></div>`).join("")}`:"";w.document.write(`<!DOCTYPE html><html><head><meta charset="utf-8"><title>Human System Studio Report - ${nick}</title><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;600;700&display=swap" rel="stylesheet"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Noto Sans Thai',sans-serif;padding:40px;color:#1E293B;max-width:700px;margin:0 auto;font-size:13px;line-height:1.7}h1{font-size:22px;margin-bottom:8px}h2{font-size:15px;margin:24px 0 8px;color:#4338CA;border-bottom:2px solid #EEF2FF;padding-bottom:4px}.bar{height:8px;border-radius:4px;margin:4px 0 10px}.card{background:#F8FAFC;border-radius:10px;padding:12px;margin:6px 0}.g{display:grid;grid-template-columns:1fr 1fr;gap:8px}.tag{display:inline-block;padding:2px 8px;border-radius:6px;font-size:11px;font-weight:700}p{margin:3px 0}</style></head><body><h1>üîÆ ${nick} ‚Äî Human System Studio Report</h1><p style="color:#64748B">Vedic Astrology + Psychology Assessment</p>${ai.identity?`<h2>‚ú¶ Identity Snapshot</h2><p>${ai.identity}</p>`:""}<h2>üìä 12 Dimension Scores</h2>${Object.entries(scores).map(([k,v])=>`<div style="margin:6px 0"><div style="display:flex;justify-content:space-between"><span>${DM[k]?.icon} ${k} (${DM[k]?.pl})</span><span style="font-weight:700;color:${DM[k]?.c}">${v.toFixed(1)}/10</span></div><div class="bar" style="background:#E2E8F0"><div style="height:100%;width:${v*10}%;background:${DM[k]?.c};border-radius:4px"></div></div></div>`).join("")}<h2>üí™ ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á</h2><div class="g">${so.slice(0,4).map(([k,v])=>`<div class="card"><span class="tag" style="background:#ECFDF5;color:#059669">${v.toFixed(1)}</span> ${DM[k]?.icon} ${k}</div>`).join("")}</div><h2>‚ö†Ô∏è ‡∏à‡∏∏‡∏î‡∏û‡∏±‡∏í‡∏ô‡∏≤</h2><div class="g">${so.slice(-4).map(([k,v])=>`<div class="card"><span class="tag" style="background:#FFF1F2;color:#EF4444">${v.toFixed(1)}</span> ${DM[k]?.icon} ${k}</div>`).join("")}</div>${ai.core?`<h2>üìä 5 Core Scores Analysis</h2><p style="white-space:pre-wrap">${ai.core}</p>`:""} ${ai["12d"]?`<h2>üï∏Ô∏è 12D Analysis</h2><p style="white-space:pre-wrap">${ai["12d"]}</p>`:""} ${ai.shadow?`<h2>üåë Shadow Analysis</h2><p>Shadow Score: ${scores["Shadow Pattern"]?.toFixed(1)}/10${vedic?` (‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏î‡∏ß‡∏á: ${vedic["Shadow Pattern"]?.toFixed(1)})`:""}</p><p style="white-space:pre-wrap">${ai.shadow}</p>`:""} ${wkHtml} ${enHtml} ${jobHtml}<p style="margin-top:30px;font-size:11px;color:#94A3B8;text-align:center">Generated by Human System Studio ¬∑ AI + Vedic Astrology ¬∑ ${new Date().toLocaleDateString("th-TH")}</p></body></html>`);w.document.close();setTimeout(()=>w.print(),500)};

  const shareProfile=()=>{if(!scores||!nick)return;const data=btoa(unescape(encodeURIComponent(JSON.stringify({n:nick,s:scores}))));navigator.clipboard?.writeText(`${window.location.origin}?p=${data}`);alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß!")};

  // ‚îÄ‚îÄ‚îÄ LANDING ‚îÄ‚îÄ‚îÄ
  const Landing=()=><div style={{minHeight:"100vh"}}>
    <div style={{textAlign:"center",padding:"60px 20px 40px",position:"relative",overflow:"hidden"}}>
      <div style={{position:"absolute",inset:0,background:"radial-gradient(ellipse at 30% 20%,rgba(67,56,202,.08),transparent 60%),radial-gradient(ellipse at 70% 80%,rgba(139,92,246,.06),transparent 50%)",zIndex:0}}/>
      <div style={{position:"relative",zIndex:1}}>
        <div style={{width:52,height:52,borderRadius:14,background:"linear-gradient(135deg,#4338CA,#6D28D9)",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:24,color:"#fff",boxShadow:"0 8px 24px rgba(67,56,202,.3)",animation:"hfl 3s ease-in-out infinite",marginBottom:16}}>‚ú¶</div>
        <h1 style={{fontSize:26,fontWeight:800,color:"#1E293B",marginBottom:6,letterSpacing:"-.5px"}}>{BRAND}</h1>
        <p style={{fontSize:15,fontWeight:600,color:"#4338CA",marginBottom:6}}>‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</p>
        <p style={{fontSize:13,color:"#64748B",lineHeight:1.7,maxWidth:380,margin:"0 auto 20px"}}>‡∏î‡πâ‡∏ß‡∏¢ AI + Vedic Astrology + ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ 36 ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</p>
        <div style={{maxWidth:280,margin:"0 auto"}}><Btn onClick={()=>setSc("profile")}>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ü‡∏£‡∏µ ‚Üí</Btn></div>
      </div>
    </div>
    <div style={{padding:"0 20px",maxWidth:520,margin:"0 auto"}}>
      <Card style={{background:"linear-gradient(135deg,#F5F3FF,#EEF2FF)",border:"1px solid #DDD6FE"}}>
        <h3 style={{fontSize:14,fontWeight:700,color:"#4338CA",marginBottom:6}}>üîé ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ "‡∏î‡∏ß‡∏á + ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°" ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô?</h3>
        <p style={{fontSize:12,color:"#374151",lineHeight:1.7}}>‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ö‡∏≤‡∏á‡∏Ñ‡∏ô "‡∏î‡∏ß‡∏á‡∏î‡∏µ" ‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô ‡πÅ‡∏•‡∏∞‡∏ö‡∏≤‡∏á‡∏Ñ‡∏ô "‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏•‡∏≤‡∏á" ‡πÅ‡∏ï‡πà‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å</p>
        <div style={{marginTop:10,padding:10,background:"#fff",borderRadius:8,textAlign:"center"}}><p style={{fontSize:14,fontWeight:700,color:"#6D28D9"}}>‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î √ó ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</p><p style={{fontSize:11,color:"#64748B",marginTop:2}}>‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏´‡∏•‡∏∏‡∏î‡∏•‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ</p></div>
      </Card>
      <div style={{marginBottom:16}}>
        <h3 style={{fontSize:14,fontWeight:700,marginBottom:8}}>3 ‡∏ä‡∏±‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
        {[{i:"ü™ê",t:"Vedic Astrology",d:"‡∏≠‡πà‡∏≤‡∏ô‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î"},{i:"üìã",t:"Psychology 36 ‡∏Ç‡πâ‡∏≠",d:"‡∏ß‡∏±‡∏î‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°"},{i:"ü§ñ",t:"AI Insight Engine",d:"‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á"}].map((x,i)=><Card key={i} style={{display:"flex",gap:10,alignItems:"center"}}><div style={{width:38,height:38,borderRadius:10,background:"#F5F3FF",display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,flexShrink:0}}>{x.i}</div><div><div style={{fontSize:13,fontWeight:700}}>{x.t}</div><div style={{fontSize:11,color:"#64748B"}}>{x.d}</div></div></Card>)}
      </div>
      <h3 style={{fontSize:14,fontWeight:700,marginBottom:8}}>‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à</h3>
      {[{p:"free",t:"üü¢ Free",pr:"‡∏ø0",d:"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",it:["Identity Snapshot (AI)","5 Core Scores + ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢","Insight ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô (Teaser)"]},{p:"deep",t:"üü° Deep Insight",pr:"‡∏ø99",d:"‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û \"‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö\"",badge:"‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°",it:["‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á/‡∏à‡∏∏‡∏î‡∏û‡∏±‡∏í‡∏ô‡∏≤ 12 ‡∏°‡∏¥‡∏ï‡∏¥","Shadow Analysis ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å","Do & Don't ‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå","7-Day Energy Forecast"]},{p:"all",t:"üîµ All Access",pr:"‡∏ø249",d:"‡πÉ‡∏ä‡πâ Insight ‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏£‡∏¥‡∏á",badge:"‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î",it:["Job Matching AI","PDF Report ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î","Shareable Profile Link"]}].map((x,i)=><Card key={i} style={{position:"relative",border:x.badge?`2px solid ${PLANS[x.p].c}`:"1px solid #F1F5F9"}}>{x.badge&&<span style={{position:"absolute",top:-10,right:12,background:PLANS[x.p].c,color:"#fff",fontSize:10,fontWeight:800,padding:"2px 10px",borderRadius:8}}>{x.badge}</span>}<div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4}}><span style={{fontSize:14,fontWeight:700}}>{x.t}</span><span style={{fontSize:17,fontWeight:800,color:PLANS[x.p].c}}>{x.pr}</span></div><p style={{fontSize:11,color:"#64748B",marginBottom:6}}>{x.d}</p>{x.it.map((it,j)=><div key={j} style={{fontSize:11,color:"#374151",padding:"2px 0"}}>‚úî {it}</div>)}</Card>)}
      <Card style={{padding:12,overflow:"auto"}}><table style={{width:"100%",borderCollapse:"collapse",fontSize:10}}><thead><tr style={{background:"#F8FAFC"}}><th style={{textAlign:"left",padding:"5px 6px",fontWeight:700,color:"#64748B"}}>‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå</th><th style={{textAlign:"center",padding:"5px 4px",fontWeight:700,color:"#10B981"}}>Free</th><th style={{textAlign:"center",padding:"5px 4px",fontWeight:700,color:"#F59E0B"}}>‡∏ø99</th><th style={{textAlign:"center",padding:"5px 4px",fontWeight:700,color:"#3B82F6"}}>‡∏ø249</th></tr></thead><tbody>{FT.map(([n,,f,d,a],i)=><tr key={i} style={{borderBottom:"1px solid #F1F5F9"}}><td style={{padding:"5px 6px"}}>{n}</td><td style={{textAlign:"center"}}>{f?"‚úÖ":"‚Äî"}</td><td style={{textAlign:"center"}}>{d?"‚úÖ":"‚Äî"}</td><td style={{textAlign:"center"}}>{a?"‚úÖ":"‚Äî"}</td></tr>)}</tbody></table></Card>
      <Card style={{background:"#F0FDF4",border:"1px solid #BBF7D0"}}><div style={{fontSize:12,fontWeight:700,color:"#166534",marginBottom:4}}>üõ° ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</div><div style={{fontSize:11,color:"#15803D",lineHeight:1.5}}>‡πÑ‡∏°‡πà‡∏Ç‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ¬∑ ‡πÑ‡∏°‡πà‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏ú‡∏• ¬∑ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</div></Card>
      <div style={{padding:"16px 0 40px"}}><Btn onClick={()=>setSc("profile")}>‡πÄ‡∏£‡∏¥‡πà‡∏° Identity Snapshot ‡∏ü‡∏£‡∏µ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ ‚Üí</Btn></div>
    </div>
  </div>;

  // ‚îÄ‚îÄ‚îÄ PROFILE ‚îÄ‚îÄ‚îÄ
  const Profile=()=>{const inp={width:"100%",padding:"10px 14px",fontSize:14,border:"2px solid #E2E8F0",borderRadius:10,outline:"none",background:"#fff",boxSizing:"border-box"};const lbl={fontSize:12,fontWeight:600,color:"#64748B",marginBottom:4,display:"block"};const ok=nick&&email&&bday&&bday.split("-").filter(x=>x&&x!=="").length===3&&(knowT===true?(btime&&btime.includes(":")):(knowT===false?tSlot:false));
  return<div><div style={{display:"flex",alignItems:"center",gap:8,marginBottom:14}}><button onClick={()=>setSc("landing")} style={{background:"none",border:"none",fontSize:18,cursor:"pointer"}}>‚Üê</button><div><div style={{fontSize:16,fontWeight:800}}>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div><div style={{fontSize:11,color:"#94A3B8"}}>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Vedic + ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</div></div></div>
  <Card><div style={{marginBottom:12}}><label style={lbl}>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô *</label><input value={nick} onChange={e=>setNick(e.target.value)} placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏¥‡∏ß" style={inp}/></div>
  <div style={{marginBottom:12}}><label style={lbl}>‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label><input value={email} onChange={e=>setEmail(e.target.value)} placeholder="your@email.com" style={inp}/></div>
  <div style={{marginBottom:12}}><label style={lbl}>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î *</label>
  <div style={{display:"flex",gap:6,marginBottom:6}}>
  <select value={bday.split("-")[2]||""} onChange={e=>{const p=bday.split("-");setBday(`${p[0]||"2000"}-${p[1]||"01"}-${e.target.value}`)}} style={{...inp,flex:1}}><option value="">‡∏ß‡∏±‡∏ô</option>{Array.from({length:31},(_,i)=>i+1).map(d=><option key={d} value={String(d).padStart(2,"0")}>{d}</option>)}</select>
  <select value={bday.split("-")[1]||""} onChange={e=>{const p=bday.split("-");setBday(`${p[0]||"2000"}-${e.target.value}-${p[2]||"01"}`)}} style={{...inp,flex:1.2}}><option value="">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>{["‡∏°.‡∏Ñ.","‡∏Å.‡∏û.","‡∏°‡∏µ.‡∏Ñ.","‡πÄ‡∏°.‡∏¢.","‡∏û.‡∏Ñ.","‡∏°‡∏¥.‡∏¢.","‡∏Å.‡∏Ñ.","‡∏™.‡∏Ñ.","‡∏Å.‡∏¢.","‡∏ï.‡∏Ñ.","‡∏û.‡∏¢.","‡∏ò.‡∏Ñ."].map((m,i)=><option key={i} value={String(i+1).padStart(2,"0")}>{m}</option>)}</select>
  <select value={bday.split("-")[0]||""} onChange={e=>{const p=bday.split("-");setBday(`${e.target.value}-${p[1]||"01"}-${p[2]||"01"}`)}} style={{...inp,flex:1}}><option value="">‡∏õ‡∏µ(‡∏Ñ.‡∏®.)</option>{Array.from({length:80},(_,i)=>2026-i).map(y=><option key={y} value={String(y)}>{y} ({y+543})</option>)}</select>
  </div>
  <button onClick={()=>{const t=new Date();setBday(`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`)}} style={{fontSize:11,color:"#6366F1",background:"#EEF2FF",border:"1px solid #C7D2FE",borderRadius:6,padding:"4px 10px",cursor:"pointer",marginBottom:4}}>üìÖ ‡πÉ‡∏ä‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
  </div>
  <div style={{marginBottom:12}}><label style={lbl}>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î *</label>
  <div style={{display:"flex",gap:6,marginBottom:8}}><button onClick={()=>{setKnowT(true);setTSlot("")}} style={{flex:1,padding:8,borderRadius:8,border:`2px solid ${knowT===true?"#6366F1":"#E2E8F0"}`,background:knowT===true?"#EEF2FF":"#fff",color:knowT===true?"#4338CA":"#64748B",fontSize:12,fontWeight:600,cursor:"pointer"}}>‡∏£‡∏π‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î</button><button onClick={()=>{setKnowT(false);setBtime("")}} style={{flex:1,padding:8,borderRadius:8,border:`2px solid ${knowT===false?"#F59E0B":"#E2E8F0"}`,background:knowT===false?"#FFFBEB":"#fff",color:knowT===false?"#92400E":"#64748B",fontSize:12,fontWeight:600,cursor:"pointer"}}>‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î</button></div>
  {knowT===true&&<div style={{display:"flex",gap:6}}><select value={btime.split(":")[0]||""} onChange={e=>{const mm=btime.split(":")[1]||"00";setBtime(`${e.target.value}:${mm}`)}} style={{...inp,flex:1}}><option value="">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</option>{Array.from({length:24},(_,i)=>i).map(h=><option key={h} value={String(h).padStart(2,"0")}>{String(h).padStart(2,"0")} ‡∏ô.</option>)}</select><select value={btime.split(":")[1]||""} onChange={e=>{const hh=btime.split(":")[0]||"00";setBtime(`${hh}:${e.target.value}`)}} style={{...inp,flex:1}}><option value="">‡∏ô‡∏≤‡∏ó‡∏µ</option>{[0,5,10,15,20,25,30,35,40,45,50,55].map(m=><option key={m} value={String(m).padStart(2,"0")}>{String(m).padStart(2,"0")} ‡∏ô‡∏≤‡∏ó‡∏µ</option>)}</select></div>}
  {knowT===false&&<div style={{display:"flex",flexDirection:"column",gap:4}}>{TS.map(ts=><button key={ts.id} onClick={()=>setTSlot(ts.id)} style={{padding:"10px 12px",borderRadius:8,border:`2px solid ${tSlot===ts.id?"#F59E0B":"#E2E8F0"}`,background:tSlot===ts.id?"#FFFBEB":"#fff",textAlign:"left",cursor:"pointer"}}><div style={{fontSize:12,fontWeight:tSlot===ts.id?700:500,color:tSlot===ts.id?"#92400E":"#374151"}}>{ts.l}</div><div style={{fontSize:10,color:"#94A3B8"}}>{ts.d}</div></button>)}</div>}</div>
  <div style={{marginBottom:14}}><label style={lbl}>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label><select value={prov} onChange={e=>setProv(e.target.value)} style={{...inp,appearance:"auto"}}><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>{PV.map(p=><option key={p} value={p}>{p}</option>)}</select></div>
  <Btn ok={ok} onClick={ok?goQuiz:undefined}>‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô 36 ‡∏Ç‡πâ‡∏≠ ‚Üí</Btn></Card></div>};

  // ‚îÄ‚îÄ‚îÄ QUIZ ‚îÄ‚îÄ‚îÄ
  const Quiz=()=>{const q=ALL_Q[qI];const key=`${q.dim}-${q.qi}`;const pct=((qI+1)/36*100);const allD=Object.keys(ans).length>=36;
  return<div><div style={{display:"flex",justifyContent:"space-between",marginBottom:6}}><span style={{fontSize:12,fontWeight:700,color:"#64748B"}}>{qI+1}/36</span><span style={{fontSize:10,color:"#94A3B8"}}>{q.dim}</span></div>
  <div style={{height:4,background:"#E2E8F0",borderRadius:2,overflow:"hidden",marginBottom:12}}><div style={{height:"100%",width:`${pct}%`,background:"linear-gradient(90deg,#4338CA,#A78BFA)",borderRadius:2,transition:"width .3s"}}/></div>
  <Card><div style={{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 10px",borderRadius:10,background:`${q.c}15`,marginBottom:8,fontSize:10,fontWeight:600,color:q.c}}>{q.icon} {q.dim} ¬∑ {q.pl}</div>
  <p style={{fontSize:14,fontWeight:500,lineHeight:1.7,marginBottom:12,color:"#1E293B"}}>{q.q}</p>
  <div style={{display:"flex",flexDirection:"column",gap:4}}>{SCALE.map((l,i)=><button key={i} onClick={()=>answer(i)} style={{padding:"9px 12px",fontSize:12,fontWeight:ans[key]===i?700:500,border:`2px solid ${ans[key]===i?"#4338CA":"#E2E8F0"}`,borderRadius:8,cursor:"pointer",textAlign:"left",background:ans[key]===i?"#EEF2FF":"#fff",color:ans[key]===i?"#4338CA":"#374151",display:"flex",alignItems:"center",gap:8}}><span style={{width:20,height:20,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:700,background:ans[key]===i?"#4338CA":"#F1F5F9",color:ans[key]===i?"#fff":"#94A3B8",flexShrink:0}}>{i}</span>{l}</button>)}</div></Card>
  <div style={{display:"flex",gap:8,marginTop:8}}><button onClick={()=>setQI(Math.max(0,qI-1))} disabled={qI===0} style={{flex:1,padding:10,border:"2px solid #E2E8F0",borderRadius:8,background:"#fff",fontSize:12,fontWeight:600,cursor:qI>0?"pointer":"not-allowed",color:qI>0?"#374151":"#CBD5E1"}}>‚Üê</button>{allD?<Btn onClick={finish} style={{flex:2}}>‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‚ú¶</Btn>:<button onClick={()=>{if(ans[key]!==undefined&&qI<35)setQI(qI+1)}} style={{flex:2,padding:10,borderRadius:8,border:"none",background:ans[key]!==undefined?"linear-gradient(135deg,#4338CA,#6D28D9)":"#E2E8F0",color:ans[key]!==undefined?"#fff":"#94A3B8",fontSize:12,fontWeight:600,cursor:ans[key]!==undefined?"pointer":"not-allowed"}}>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>}</div></div>};

  // ‚îÄ‚îÄ‚îÄ RESULTS ‚îÄ‚îÄ‚îÄ
  const Sec=({fKey,title,icon,children})=>{const ok=has(fKey);return<Card style={{position:"relative"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:ok?8:4}}><div style={{display:"flex",alignItems:"center",gap:6}}><span style={{fontSize:15}}>{icon}</span><span style={{fontSize:13,fontWeight:700}}>{title}</span></div>{!ok&&<span style={{fontSize:10,fontWeight:700,color:"#6366F1",background:"#EEF2FF",padding:"2px 8px",borderRadius:8}}>üîí</span>}</div>{ok?children:<><p style={{fontSize:11,color:"#94A3B8",marginBottom:6}}>‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ô‡∏µ‡πâ</p><div style={{display:"flex",gap:6}}>{plan==="free"&&<button onClick={()=>upgradePlan("deep")} style={{flex:1,padding:7,borderRadius:8,border:"2px solid #F59E0B",background:"#FFFBEB",color:"#92400E",fontSize:11,fontWeight:700,cursor:"pointer"}}>Deep ‡∏ø99</button>}{plan!=="all"&&<button onClick={()=>upgradePlan("all")} style={{flex:1,padding:7,borderRadius:8,border:"none",background:"linear-gradient(135deg,#4338CA,#6D28D9)",color:"#fff",fontSize:11,fontWeight:700,cursor:"pointer"}}>All ‡∏ø249</button>}</div></>}</Card>};

  const Results=()=>{if(!scores)return null;const so=Object.entries(scores).sort((a,b)=>b[1]-a[1]);const c5={"Cognitive Processing":scores["Cognitive Processing"],"Emotional Regulation":scores["Emotional Regulation"],"Identity Stability":scores["Identity Stability"],"Shadow Pattern":scores["Shadow Pattern"],"Growth Orientation":scores["Growth Orientation"]};
  return<div>
  <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}}><div><div style={{display:"flex",alignItems:"center",gap:6}}><div style={{width:26,height:26,borderRadius:8,background:"linear-gradient(135deg,#4338CA,#6D28D9)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,color:"#fff"}}>‚ú¶</div><span style={{fontSize:14,fontWeight:800}}>{nick}</span></div><span style={{fontSize:10,color:"#94A3B8"}}>{PLANS[plan].name}</span></div>{plan!=="free"&&<span style={{fontSize:10,fontWeight:700,color:"#fff",background:PLANS[plan].c,padding:"3px 10px",borderRadius:8}}>{PLANS[plan].name}</span>}</div>

  {plan==="free"&&<Card style={{background:"linear-gradient(135deg,#EEF2FF,#F5F3FF)",border:"2px solid #6366F1"}}><div style={{fontSize:12,fontWeight:700,color:"#4338CA",marginBottom:6}}>üîì ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á</div><div style={{display:"flex",gap:6}}><button onClick={()=>upgradePlan("deep")} style={{flex:1,padding:7,borderRadius:8,border:"2px solid #F59E0B",background:"#fff",color:"#92400E",fontSize:11,fontWeight:700,cursor:"pointer"}}>Deep ‡∏ø99</button><button onClick={()=>upgradePlan("all")} style={{flex:1,padding:7,borderRadius:8,border:"none",background:"linear-gradient(135deg,#4338CA,#6D28D9)",color:"#fff",fontSize:11,fontWeight:700,cursor:"pointer"}}>All ‡∏ø249</button></div></Card>}

  <Sec fKey="identity" title="Identity Snapshot" icon="‚ú¶">{ai.identity?<Typer text={ai.identity}/>:aiL.identity?<Spin/>:<Spin t="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° AI..."/>}</Sec>

  <Sec fKey="core5" title="5 Core Scores" icon="üìä">{Object.entries(c5).map(([d,s])=><div key={d} style={{marginBottom:8}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:2}}><span style={{fontSize:11,fontWeight:600}}>{DM[d]?.icon} {d} <span style={{fontSize:9,color:"#94A3B8"}}>({DM[d]?.pl})</span></span><span style={{fontSize:11,fontWeight:700,color:DM[d]?.c}}>{s.toFixed(1)}</span></div><div style={{height:5,background:"#F1F5F9",borderRadius:3,overflow:"hidden"}}><div style={{height:"100%",width:`${s*10}%`,background:DM[d]?.c,borderRadius:3,transition:"width .8s"}}/></div></div>)}<div style={{marginTop:8,padding:8,background:"#F8FAFC",borderRadius:8}}>{aiL.core?<Spin/>:ai.core?<Typer text={ai.core}/>:<Spin t="‡∏£‡∏≠ AI..."/>}</div></Sec>

  <Sec fKey="12d" title="12D Spider Web" icon="üï∏Ô∏è"><div style={{display:"flex",justifyContent:"center",marginBottom:8}}><Spider scores={scores}/></div><div style={{marginBottom:6}}><div style={{fontSize:11,fontWeight:700,color:"#10B981",marginBottom:3}}>üí™ ‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á</div>{so.slice(0,4).map(([d,s])=><div key={d} style={{padding:"4px 8px",borderRadius:6,background:"#ECFDF5",border:"1px solid #A7F3D0",marginBottom:2,display:"flex",justifyContent:"space-between",fontSize:11}}><span>{DM[d]?.icon} {d}</span><span style={{fontWeight:700,color:"#059669"}}>{s.toFixed(1)}</span></div>)}</div><div><div style={{fontSize:11,fontWeight:700,color:"#EF4444",marginBottom:3}}>‚ö†Ô∏è ‡∏à‡∏∏‡∏î‡∏û‡∏±‡∏í‡∏ô‡∏≤</div>{so.slice(-4).map(([d,s])=><div key={d} style={{padding:"4px 8px",borderRadius:6,background:"#FFF1F2",border:"1px solid #FECDD3",marginBottom:2,display:"flex",justifyContent:"space-between",fontSize:11}}><span>{DM[d]?.icon} {d}</span><span style={{fontWeight:700,color:"#EF4444"}}>{s.toFixed(1)}</span></div>)}</div>{aiL["12d"]?<Spin/>:ai["12d"]?<div style={{marginTop:8,padding:8,background:"#F8FAFC",borderRadius:8}}><Typer text={ai["12d"]}/></div>:null}</Sec>

  <Sec fKey="shadow" title="Shadow Analysis" icon="üåë"><div style={{padding:10,borderRadius:10,background:"linear-gradient(135deg,#1E293B,#334155)",color:"#fff",marginBottom:6}}><div style={{fontSize:12,fontWeight:700}}>üåë Shadow (‡∏£‡∏≤‡∏´‡∏π/‡πÄ‡∏Å‡∏ï‡∏∏): {scores["Shadow Pattern"]?.toFixed(1)}/10</div>{vedic&&<div style={{fontSize:10,color:"#94A3B8",marginTop:2}}>‡∏î‡∏ß‡∏á:{vedic["Shadow Pattern"]?.toFixed(1)} ¬∑ gap:{Math.abs(vedic["Shadow Pattern"]-scores["Shadow Pattern"]).toFixed(1)}</div>}</div>{aiL.shadow?<Spin/>:ai.shadow?<Typer text={ai.shadow}/>:<Spin t="‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏á‡∏≤‡∏°‡∏∑‡∏î..."/>}</Sec>

  <Sec fKey="weekly" title="Do & Don't ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ" icon="üìã">{aiL.weekly?<Spin/>:ai.weekly&&typeof ai.weekly==="object"?<><div style={{fontSize:11,fontWeight:700,color:"#10B981",marginBottom:3}}>‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥</div>{(ai.weekly.do||[]).map((t,i)=><div key={i} style={{padding:"5px 8px",borderRadius:6,background:"#ECFDF5",border:"1px solid #A7F3D0",fontSize:11,marginBottom:2}}>{t}</div>)}<div style={{fontSize:11,fontWeight:700,color:"#EF4444",marginBottom:3,marginTop:6}}>‚ùå ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á</div>{(ai.weekly.dont||[]).map((t,i)=><div key={i} style={{padding:"5px 8px",borderRadius:6,background:"#FFF1F2",border:"1px solid #FECDD3",fontSize:11,marginBottom:2}}>{t}</div>)}</>:<Spin/>}</Sec>

  <Sec fKey="energy" title="7-Day Energy" icon="üåô">{aiL.energy?<Spin/>:ai.energy&&Array.isArray(ai.energy)?ai.energy.map((d,i)=><div key={i} style={{padding:"6px 8px",borderRadius:6,marginBottom:2,background:i===0?"#EEF2FF":"#F8FAFC",border:i===0?"2px solid #6366F1":"none",display:"flex",justifyContent:"space-between",alignItems:"center"}}><div><div style={{fontSize:11,fontWeight:700}}>{i===0?"üìç":""}{d.day}</div><div style={{fontSize:9,color:"#64748B"}}>{d.mood}</div></div><span style={{fontSize:12,fontWeight:700,color:d.energy>70?"#10B981":d.energy>50?"#F59E0B":"#EF4444"}}>{d.energy}%</span></div>):<Spin/>}</Sec>

  <Sec fKey="job" title="Job Matching AI" icon="üíº">{aiL.job?<Spin/>:ai.job&&Array.isArray(ai.job)?ai.job.map((j,i)=><div key={i} style={{padding:8,borderRadius:8,background:"#F8FAFC",marginBottom:3}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:2}}><span style={{fontSize:12,fontWeight:700}}>{j.title}</span><span style={{fontSize:9,fontWeight:700,color:"#4338CA",background:"#EEF2FF",padding:"2px 6px",borderRadius:6}}>{j.match}%</span></div><div style={{fontSize:10,color:"#64748B"}}>{j.reason}</div></div>):<Spin/>}</Sec>

  <Sec fKey="pdf" title="PDF Report" icon="üìÑ"><Btn onClick={exportPDF} style={{fontSize:12,padding:8}}>üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</Btn></Sec>
  <Sec fKey="share" title="Share Profile" icon="üîó"><Btn onClick={shareProfile} style={{fontSize:12,padding:8,background:"linear-gradient(135deg,#059669,#10B981)"}}>üîó ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ä‡∏£‡πå</Btn></Sec>

  <div style={{textAlign:"center",padding:"14px 0 40px"}}><button onClick={()=>{setSc("landing");setScores(null);setVedic(null);setAns({});setAi({});setQI(0);setPlan("free");localStorage.clear()}} style={{fontSize:11,color:"#94A3B8",background:"none",border:"none",cursor:"pointer"}}>üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button></div>
  </div>};

  return<div style={{fontFamily:"'Noto Sans Thai','DM Sans',-apple-system,sans-serif",minHeight:"100vh",background:"#F8FAFC",color:"#1E293B"}}><style>{css}</style><div style={{maxWidth:520,margin:"0 auto",padding:sc==="landing"?"0":"12px 16px 40px"}}>{sc==="landing"&&<Landing/>}{sc==="profile"&&<Profile/>}{sc==="quiz"&&<Quiz/>}{sc==="results"&&<Results/>}</div></div>;
}
